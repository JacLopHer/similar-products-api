server:
  port: 5000
  tomcat:
    max-connections: 10000
    threads:
      max: 400
    accept-count: 1000
    connection-timeout: 20s
    keep-alive-timeout: 60s
    max-keep-alive-requests: 100

spring:
  application:
    name: similar-products-api
  cache:
    caffeine:
      spec: maximumSize=10000,expireAfterWrite=10m

external-apis:
  product-service:
    base-url: http://localhost:3001
    timeout: 5000

resilience4j:
  circuitbreaker:
    instances:
      productService:
        slidingWindowSize: 10
        failureRateThreshold: 50
        waitDurationInOpenState: 10000
        permittedNumberOfCallsInHalfOpenState: 3
        automaticTransitionFromOpenToHalfOpenEnabled: true

  retry:
    instances:
      productService:
        maxAttempts: 3
        waitDuration: 1000
        exponentialBackoffMultiplier: 2
        retryExceptions:
          - org.springframework.web.reactive.function.client.WebClientRequestException
          - java.util.concurrent.TimeoutException

logging:
  level:
    com.company.similarproducts: INFO
    org.springframework.web: INFO
